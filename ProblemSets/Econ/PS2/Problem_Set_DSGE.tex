\documentclass[letterpaper,12pt]{article}
\usepackage{array}
\usepackage{threeparttable}
\usepackage{geometry}
\geometry{letterpaper,tmargin=1in,bmargin=1in,lmargin=1.25in,rmargin=1.25in}
\usepackage{fancyhdr,lastpage}
\pagestyle{fancy}
\lhead{}
\chead{}
\rhead{}
\lfoot{}
\cfoot{}
\rfoot{\footnotesize\textsl{Page \thepage\ of \pageref{LastPage}}}
\renewcommand\headrulewidth{0pt}
\renewcommand\footrulewidth{0pt}
\usepackage[format=hang,font=normalsize,labelfont=bf]{caption}
\usepackage{listings}
\lstset{frame=single,
  language=Python,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  breaklines=true,
  breakatwhitespace=true
  tabsize=3
}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{harvard}
\usepackage{setspace}
\usepackage{float,color}
\usepackage[pdftex]{graphicx}
\usepackage{hyperref}
\hypersetup{colorlinks,linkcolor=black,urlcolor=blue}
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{derivation}{Derivation} % Number derivations on their own
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{proposition}{Proposition} % Number propositions on their own
\newtheorem{remark}[theorem]{Remark}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
%\numberwithin{equation}{section}
\bibliographystyle{aer}
\newcommand\ve{\varepsilon}
\newcommand\boldline{\arrayrulewidth{1pt}\hline}


\begin{document}

\begin{flushleft}
  \textbf{\large{Problem Set: DSGE}} \\
  OSELab 2019\\
  Luca Maria Sch√ºpbach
\end{flushleft}

\vspace{5mm}

\noindent\textbf{Exercise 1}
Consumers in the Brock and Mirman model do not face a trade-off between labor and leisure.We can solve the model by guessing an initial policy function:
\begin{equation}
K_{t+1}=A e^{z_t}K_t^{\alpha}
\end{equation}
\begin{equation}
  K_{t+2}=Ae^{\rho z_t}[Ae^{z_t}K_t^{\alpha}]^{\alpha}
\end{equation}

Pluging in (1) and (2), the Euler equation becomes:

$$\frac{1}{e^{z_{t}} K_{t}^{\alpha}-Ae^{z_{t}} K_{t}^{\alpha}}=\frac{\beta \alpha e^{\rho z_{t}}(A e^{z_{t}} K_{t}^{\alpha})^{\alpha-1}}{e^{\rho z_t}(Ae^{\rho z_t}K_t^{\alpha})^{\alpha}-Ae^{\rho z_t}(Ae^{z_t}K_t^{\alpha})^{\alpha}}=\frac{\beta \alpha e^{\rho z_{t}}(A e^{z_{t}} K_{t}^{\alpha})^{\alpha-1}}{e^{\rho z_{t}}(A e^{z_{t}} K_{t}^{\alpha})^{\alpha}(1-A)} $$

$$\iff \frac{A e^{z_t} K_t^{\alpha}}{e^{z_t}K_t^{\alpha}(1-A)}=\frac{\alpha \beta}{(1-A)}$$

$$\iff A= \alpha \beta $$

\vspace{3mm}

\noindent\textbf{Exercise 2}

Functional forms:
$$u(c_{t}, l_{t})=\ln (c_{t})+\alpha \ln (1-l_{t})$$
$$F(K_{t}, l_{t}, z_{t})=e^{z_{t}} K_{t}^{\alpha} L_{t}^{1-\alpha}$$

Characterizing equations:

\begin{equation}
  \label{metric}
  c_{t}=(1-\tau)[w_{t} l_{t}+(r_{t}-\delta)k_{t}]+k_{t}+T_{t}-k_{t+1}
\end{equation}

\begin{equation}
  \label{metric}
  \frac{1}{c_t}=\beta E\{ \frac{1}{c_{t+1}}[(r_{t+1}-\delta)(1-\tau)+1]\}
\end{equation}

\begin{equation}
  \frac{\alpha}{1-l_t}=\frac{1}{c_t}w_t(1-\tau)
\end{equation}

\begin{equation}
  \label{metric}
  r_t=\alpha e^{z_t}k_t^{\alpha-1} l_t^{1-\alpha}
\end{equation}

\begin{equation}
  w_t=(1-\alpha)e^{z_t}k_t^{\alpha}l_t^{-\alpha}
\end{equation}

\begin{equation}
  \tau(w_tl_t+(r_t-\delta)k_t) = T_t
\end{equation}

\begin{equation}
  \label{metric}
  z_t=(1-\rho_t) \overline{z} +\rho_t z_{t-1} +\epsilon^z_t
\end{equation}

We cannot use the same trick as in exercise 1. The reason is that leisure now enters the utility function and the consumer faces the labor-leisure trade-off. The expectation in the Euler Equation would no longer disappear and hence, we could not solve it with the same approach as before anymore.

\vspace{3mm}

\noindent\textbf{Exercise 3}

Functional forms:
$$u(c_{t}, l_{t})=\frac{c_t^{1-\gamma}-1}{1-\gamma}+\alpha ln(1-l_t)$$
$$F(K_{t}, l_{t, z_{t}})=e^{z_{t}} K_{t}^{\alpha} l_{t}^{1-\alpha}$$

Characterizing equations:

\begin{equation}
  c_{t}=(1-\tau)[w_{t} l_{t}+(r_{t}-\delta)k_{t}]+k_{t}+T_{t}-k_{t+1}
\end{equation}

\begin{equation}
  c_t^{-\gamma}=\beta E\{{c_{t+1}}^{-\gamma} [(r_{t+1}-\delta)(1-\tau)+1]\}
\end{equation}

\begin{equation}
  \frac{\alpha}{1-l_t}=c_t^{-\gamma} w_t(1-\tau)
\end{equation}

\begin{equation}
  r_t=\alpha e^{z_t}k_t^{\alpha-1} l_t^{1-\alpha}
\end{equation}

\begin{equation}
  w_t=(1-\alpha)e^{z_t}k_t^{\alpha}l_t^{-\alpha}
\end{equation}

\begin{equation}
  \tau(w_tl_t+(r_t-\delta)k_t) = T_t
\end{equation}

\begin{equation}
  z_t=(1-\rho_t) \overline{z} +\rho_t z_{t-1} +\epsilon^z_t
\end{equation}

\vspace{3mm}

\noindent\textbf{Exercise 4}

Functional forms:

$$u\left(c_{t}, l_{t}\right)=\frac{c_{t}^{1-\gamma}-1} {1-\gamma}+a\frac{\left(1-\ell_{t}\right)^{1-\xi}-1}{1-\xi}$$

$$F\left(K_{t}, L_{t}, z_{t}\right)=e^{z_{t}}\left[\alpha K_{t}^{\eta}+(1-\alpha) L_{t}^{\eta}\right]^{\frac{1}{\eta}}$$

Characterizing equations:

\begin{equation}
  c_{t}=(1-\tau)\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]+k_{t}+T_{t}-k_{t+1}
\end{equation}

\begin{equation}
  c_{t}^{-\gamma}=\beta E\left\{c_{t+1}^{-\gamma}\left[\left(r_{t+1}-\delta\right)(1-\tau)+1\right]\right\}
\end{equation}

\begin{equation}
  a\left(1-l_{t}\right)^{-\xi}=c_{t}^{-\gamma} w_{t}(1-\tau)
\end{equation}

\begin{equation}
  r_{t}=e^{z_{t}} \alpha k_{t}^{\eta-1}\left(\alpha k_{t}^{\eta}+(1-\alpha) l_{t}^{\eta}\right)^{{1 / \eta}-1}
\end{equation}

\begin{equation}
  w_{t}=e^{z_{t}}(1-\alpha) l_{t}^{\eta-1}\left(\alpha k_{t}^{\eta}+(1-\alpha) l_{t}^{n}\right)^{{1 / \eta}-1}
\end{equation}

\begin{equation}
  \tau\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]=T_{t}
\end{equation}

\begin{equation}
  z_{t}=\left(1-\rho_{z}\right) \overline{z}+\rho_{z} z_{t-1}+\epsilon_{t}^{z}
\end{equation}

\noindent\textbf{Exercise 5}

From the exercise:

$$u\left(c_{t}\right) =\frac{c_{t}^{1-\gamma}-1}{1-\gamma}$$

$$F\left(K_{t}, L_{t}, z_{t}\right) =K_{t}^{\alpha}\left(L_{t} e^{z_{t}}\right)^{1-\alpha}$$

Characterizing equations:

\begin{equation}
  c_{t}=(1-\tau)\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]+k_{t}+T_{t}-k_{t+1}
\end{equation}

\begin{equation}
  c_{t}^{-\gamma}=\beta E\left\{c_{t+1}^{-\gamma}\left[\left(r_{t+1}-\delta\right)(1-\tau)+1\right]\right\}
\end{equation}

\begin{equation}
  u_{l_t}(c_t,l_t)=c_{t}^{-\gamma}w_t(1-\tau)
\end{equation}

\begin{equation}
  r_{t}=\alpha k_{t}^{\alpha-1}\left(l_t e^{z_{t}}\right)^{1-\alpha}
\end{equation}

\begin{equation}
  w_{t}=(1-\alpha) k_{t}^{\alpha} l_t^{-\alpha}e^{(1-\alpha) z_{t}}
\end{equation}

\begin{equation}
  \tau\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]=T_{t}
\end{equation}

\begin{equation}
  z_{t}=\left(1-\rho_{z}\right) \overline{z}+\rho_{z} z_{t-1}+\epsilon_{t}^{z}
\end{equation}

Steady State equations: (using $\overline{z}=0$ and $l_t$=1)

\begin{equation}
  \overline{c}=(1-\tau)[\overline{w}+(\overline{r}-\delta) \overline{k}]+\overline{T}
\end{equation}

\begin{equation}
  \overline{c}^{-\gamma}=\beta\left(\overline{c}^{-\gamma}(\overline{r}-\delta)(1-\tau)+1\right) ]
\end{equation}

\begin{equation}
  u_{\overline{l}}(\overline{c}, \tau)=\overline{c}^{-\gamma} \overline{w}(1-\tau)
\end{equation}

\begin{equation}
  \overline{r}=\alpha \overline{k}^{\alpha-1}
\end{equation}

\begin{equation}
  \overline{w}=(1-\alpha) \overline{k}^{\alpha}
\end{equation}

\begin{equation}\label{ref1}
  \tau[\overline{w}+(\overline{r}-\delta) \overline{k}]=\overline{T}
\end{equation}

Plug (36) into (31):

\begin{equation}
  \overline{c}=\overline{w}+(\overline{r}-\delta) \overline{k}
\end{equation}

re-write (32):

$$1=\beta(\overline{r}-\delta)(1-\tau)+\beta$$

$$1-\beta=\beta \overline{r}(1-\tau)-\beta \delta(1-\tau)$$

\begin{equation}\label{r}
  \overline{r}=\frac{1-\beta}{\beta(1-\tau)}+\delta
\end{equation}

Plug $\overline{r}$ into (38):

\begin{equation}
  \overline{k}=\left(\frac{\overline{r}}{\alpha}\right)^{\frac{1}{\alpha-1}}=\left(\frac{1-\beta}{\alpha \beta(1-\tau)}+\delta\right)^{\frac{1}{\alpha-1}}
\end{equation}

Investment as defined in the readings:

$$I=k_{t+1}-(1-\delta) k_{t}$$

In the steady state: $k_{t+1}=k_{t}=\overline{k}$
Hence,

$$I=\delta \overline{k}$$

Output:

$$\overline{y}=\overline{k}^{\alpha}$$

Plugging in the given parameters into the steady state value of $\overline{k}$ = 7.2875, I = 0.7288, $\overline{y}$ = 2.2133. Solving this problem numerically in python yields to a solution that is extremely close to what I derived analytically (please see .ipyn file for numerical solution).

\vspace{5mm}

\noindent\textbf{Exercise 6}

Functional forms:

$$u\left(c_{t}, l_{t}\right)=\frac{c_{t}^{1-\gamma}-1} {1\gamma}+a \frac{\left(1-\ell_{t}\right)^{1-\xi}-1}{1-\xi}$$

$$F\left(K_{t}, L_{t}, z_{t}\right) =K_{t}^{a}\left(L_{t} e^{z_{t}}\right)^{1-\alpha}$$

Characterizing equations:

\begin{equation}
  c_{t}=(1-\tau)\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]+k_{t}+T_{t}-k_{t+1}
\end{equation}

\begin{equation}
  c_{t}^{-\gamma}=\beta E\left\{c_{t+1}^{-\gamma}\left[\left(r_{t+1}-\delta\right)(1-\tau)+1\right]\right\}
\end{equation}

\begin{equation}
  a\left(1-l_{t}\right)^{-\xi}=c_{t}^{-\gamma} w_{t}(1-\tau)
\end{equation}

\begin{equation}
  r_{t}=\alpha k_{t}^{\alpha-1}\left(l_t e^{z_{t}}\right)^{1-\alpha}
\end{equation}

\begin{equation}
  w_{t}=(1-\alpha) k_{t}^{\alpha} l_t^{-\alpha}e^{(1-\alpha) z_{t}}
\end{equation}

\begin{equation}
  \tau\left[w_{t} l_{t}+\left(r_{t}-\delta\right) k_{t}\right]=T_{t}
\end{equation}

\begin{equation}
  z_{t}=\left(1-\rho_{z}\right) \overline{z}+\rho_{z} z_{t-1}+\epsilon_{t}^{z}
\end{equation}

Steady State equations:

\begin{equation}
  \overline{c}=(1-\tau)[\overline{w}\overline{l}+(\overline{r}-\delta) \overline{k}]+\overline{T}
\end{equation}

\begin{equation}
  1=\beta[(\overline{r}-\delta)(1-\tau)+1]
\end{equation}

\begin{equation}
  a(1-\overline{l})^{-\xi}=\overline{c}^{-\gamma}\overline{w}(1-\tau)
\end{equation}

\begin{equation}
  \overline{r}=\alpha \overline{k}^{\alpha-1}\overline{l}^{-\alpha}
\end{equation}

\begin{equation}
  \overline{w}=(1-\alpha) \overline{k}^{\alpha} \overline{l}^{-\alpha}
\end{equation}

\begin{equation}
  \tau[\overline{w}\overline{l}+(\overline{r}-\delta) \overline{k}]=\overline{T}
\end{equation}

(please see .ipyn file for solution)

\vspace{5mm}

\noindent\textbf{Exercise 7}
(please see .ipyn file for solution)

 \newpage

\begin{flushleft}
  \textbf{\large{Problem Set: Linear}} \\
\end{flushleft}

\vspace{5mm}

\noindent\textbf{Exercise 1}

To find the analytical values of F,G,H,L,M, N to the Brock and Mirman model in use Uhlig‚Äôs notation I start from the following notation from the lecture slides:

\begin{equation}
  E_{t}\left\{\beta \frac{\alpha e^{z_{t+1}} K_{t+1}^{\alpha-1}\left(e^{z_{t}} K_{t}^{\alpha}-K_{t+1}\right)}{e^{z_{t+1}} K_{t+1}^{\alpha}-K_{t+2}}\right\}=1
\end{equation}

Take FOCs (to be consistent with the lecture notes, but i think we're missing Beta in the lecture notes):

\begin{equation*}
  \begin{aligned} F &=\beta\frac{\alpha \overline{K}^{\alpha-1}}{\overline{K}^{\alpha}-\overline{K}} \\ G &=-\beta\frac{\alpha \overline{K}^{\alpha-1}\left(\alpha+\overline{K}^{\alpha-1}\right)}{\overline{K}^{\alpha}-\overline{K}} \\ H &=\beta\frac{\alpha^{2} \overline{K}^{2(\alpha-1)}}{\overline{K}^{\alpha}-\overline{K}} \\ L &=-\beta\frac{\alpha \overline{K}^{2 \alpha-1}}{\overline{K}^{\alpha}-\overline{K}} \\ M &=\beta\frac{\alpha^{2} \overline{K}^{2(\alpha-1)}}{\overline{K}^{\alpha}-\overline{K}} \end{aligned}
\end{equation*}

Further:
$$N=\rho$$

(please see .ipyn file for solution)

\noindent\textbf{Exercise 2}
(please see .ipyn file for solution)

\noindent\textbf{Exercise 3}

Given:

\begin{equation}
  E_{t}\left\{F \tilde{X}_{t+1}+G \tilde{X}_{t}+H \tilde{X}_{t-1}+L \tilde{Z}_{t+1}+M \tilde{Z}_{t}\right\}=0
\end{equation}

\begin{equation}
  \tilde{Z}_{t}=N \tilde{Z}_{t-1}+\varepsilon_{t}
\end{equation}

\begin{equation}
  \tilde{X}_{t}=P \tilde{X}_{t-1}+Q \tilde{Z}_{t}
\end{equation}
\\ The goal is to express equation (1) in terms of $\tilde{X}_{t-1}$ and $\tilde{Z}_{t}$. Successively plugging (2) and (3) into (1):
$$E_{t}\left\{F (P \tilde{X}_{t}+Q \tilde{Z}_{t+1})+G (P \tilde{X}_{t-1}+Q \tilde{Z}_{t})+H \tilde{X}_{t-1}+L(N \tilde{Z}_{t-1}+\varepsilon_{t})+M \tilde{Z}_{t}\right\}=0$$
$$E_{t}\left\{F (P (P \tilde{X}_{t-1}+Q \tilde{Z}_{t})+Q (\tilde{Z}_{t}+\varepsilon_{t+1}))+G (P \tilde{X}_{t-1}+Q \tilde{Z}_{t})+H \tilde{X}_{t-1}+L(N \tilde{Z}_{t-1}+\varepsilon_{t})+M \tilde{Z}_{t}\right\}=0$$

$$E_{t}[\varepsilon_{t}=0]\;\forall t$$
\\ Hence, we can re-write:

$$F(P (P \tilde{X}_{t-1}+Q \tilde{Z}_{t})+Q (\tilde{Z}_{t}+\varepsilon_{t+1}))+G (P \tilde{X}_{t-1}+Q \tilde{Z}_{t})+H \tilde{X}_{t-1}+L(N \tilde{Z}_{t-1}+\varepsilon_{t})+M \tilde{Z}_{t}=0$$
\\ which is equivalent to:

$$[(F P+G) P+H] \tilde{X}_{t-1}+[(F Q+L) N+(F P+G) Q+M] \tilde{Z}_{t}=0$$

\vspace{5mm}

\noindent\textbf{Exercise 4}
(please see .ipyn file for solution)

\noindent\textbf{Exercise 5}
(please see .ipyn file for solution)

\noindent\textbf{Exercise 6}
(please see .ipyn file for solution)

\noindent\textbf{Exercise 7}
(please see .ipyn file for solution)

\noindent\textbf{Exercise 8}
(will be done in .ipyn if time allows)

\noindent\textbf{Exercise 9}
(please see .ipyn file for solution)

\begin{flushleft}
  \textbf{\large{Problem Set: Pertubation}} \\
\end{flushleft}

\vspace{5mm}

\noindent\textbf{Exercise 1}

Starting from equation (5) from the readings:

\begin{equation}
  \begin{aligned} & F_{x x}\{x(u), u\} x_{u}(u) x_{u}(u)+F_{x u}\{x(u), u\} x_{u}(u) \\+& F_{x}\{x(u), u\} x_{u u}(u)+F_{x u}\{x(u), u\} x_{u}(u) \\+& F_{u u}\{x(u), u\}=0 \end{aligned}
\end{equation}

Taking FOC wrt u again:

\begin{equation}
  \begin{aligned} & F_{x x x}\{x(u), u\} x_{u}(u)^3+3*
    (F_{x x u}\{x(u), u\}x_{u}(u)^2
    \\+& F_{u u x}\{x(u), u\}x_{u}(u) + (F_{x u}\{x(u), u\}x_{u u}(u)
    \\+& F_{x x}\{x(u), u\}x_{u}(u)x_{u u}(u)) + F_{x}\{x(u), u\}x_{u u u}(u)
    \\+& F_{u u u}\{x(u), u\}= 0\end{aligned}
  \end{equation}

re-arrange yields to (choosing shorter notation for space reasons):

\begin{equation}
  x_{u u u}=-\frac{F_{x x x} x_{u}^{3}+3\left(F_{x x u} x_{u}^{2}+F_{u u x} x_{u}+F_{x u} x_{u u}+F_{x x} x_{u} x_{u u}\right)+F_{u u u}}{F_{x}}
\end{equation}

\end{document}
